from movie_lib import Movie, average_rating, get_ratings_for_movie
from movie_lib import ratings_written, movies_seen, ratings_by_movie
from movie_lib import ratings_by_user, movie_table


def test_get_title_from_id():
    assert movie_table['21'].get_title_from_id('21') == 'Muppet Treasure Island (1996)'


def test_check_topic():
    assert movie_table['472'].check_topic('472') == 'Action, Adventure, Fantasy'


def test_average_rating():
    count = 0
    ratings_for_750 = [5, 4, 2, 5, 4, 4, 4, 4, 4, 5, 4, 4, 1, 1, 5, 2, 3, 5, 4,
                       4, 5, 3, 4, 5, 5, 1, 4, 4, 5, 5, 3, 4, 5, 5, 3, 3, 3, 4,
                       3, 3, 5, 5, 4, 4, 3, 5, 5, 5, 5, 2, 2, 5, 5, 5, 5, 5, 5,
                       4, 2, 5, 5, 4, 4, 4, 4, 5, 2, 4, 2, 3, 3, 4, 2, 3, 5, 5,
                       5, 5, 5, 5, 3, 3, 5, 4, 3, 4, 3, 4, 2, 3, 4, 4, 3, 3, 4,
                       3, 3, 5, 4, 5, 2, 4, 5, 2, 5, 2, 3, 4, 3, 4, 4, 4, 5, 4,
                       4, 4, 4, 4, 5, 3, 5, 3, 4, 3]
    total = sum(ratings_for_750)
    count = len(ratings_for_750)
    av = total/count
    assert average_rating('750') == av


def test_get_ratings_for_movie():
    assert get_ratings_for_movie('750') == [5, 4, 2, 5, 4, 4, 4, 4, 4, 5, 4, 4,
                                            1, 1, 5, 2, 3, 5, 4, 4, 5, 3, 4, 5,
                                            5, 1, 4, 4, 5, 5, 3, 4, 5, 5, 3, 3,
                                            3, 4, 3, 3, 5, 5, 4, 4, 3, 5, 5, 5,
                                            5, 2, 2, 5, 5, 5, 5, 5, 5, 4, 2, 5,
                                            5, 4, 4, 4, 4, 5, 2, 4, 2, 3, 3, 4,
                                            2, 3, 5, 5, 5, 5, 5, 5, 3, 3, 5, 4,
                                            3, 4, 3, 4, 2, 3, 4, 4, 3, 3, 4, 3,
                                            3, 5, 4, 5, 2, 4, 5, 2, 5, 2, 3, 4,
                                            3, 4, 4, 4, 5, 4, 4, 4, 4, 4, 5, 3,
                                            5, 3, 4, 3]


def test_ratings_written():
    ratingslisted = [4, 4, 3, 5, 4, 5, 3, 5, 5, 5, 4, 4, 4, 4, 4, 4, 5, 4, 4,
                     4, 4, 5, 4, 4, 3, 5, 4, 3, 5, 4, 3, 4, 5, 5, 4, 4, 4, 4,
                     4, 4, 5, 5, 4, 5, 5, 4, 5, 4, 5, 5, 4, 4, 3, 4, 4, 4, 4,
                     5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 5, 5, 4, 4, 4,
                     4, 4, 4, 5, 5, 5, 5, 5, 4, 4, 3, 4, 4, 4, 4, 5, 4, 5, 5,
                     5, 4, 4, 3, 5, 5, 4, 5, 5, 4, 4, 4, 4, 4, 5, 4, 4, 4, 4,
                     4, 4, 4, 4, 5, 4, 5, 5, 4, 3, 5, 3, 4, 4, 4, 4, 3, 4, 4,
                     3, 4, 4, 5, 4, 3, 4, 4, 5, 4, 4, 5, 4, 4, 4, 5, 4, 4, 5,
                     4, 4, 4, 4, 5, 4, 4, 4, 5, 4, 4, 3, 5, 4, 5, 4, 5, 4, 4,
                     4, 5, 4, 5, 5, 4, 5, 5, 4, 4, 4, 4, 3]
    rw = ratings_written('10')
    assert rw.sort() == ratingslisted.sort()


def test_movies_seen():
    watchedmovies = ['16', '486', '175', '611', '7', '100', '461', '488',
                     '285', '504', '289', '340', '505', '489', '657', '463',
                     '655', '321', '48', '203', '218', '124', '283', '4',
                     '704', '22', '155', '294', '656', '64', '702', '615',
                     '200', '223', '651', '711', '705', '696', '367', '509',
                     '135', '489', '164', '191', '496', '385', '519', '156',
                     '703', '99', '194', '588', '695', '447', '418', '160',
                     '176', '435', '706', '275', '371', '234', '168', '497',
                     '475', '269', '493', '495', '195', '521', '13', '183',
                     '132', '420', '712', '186', '199', '710', '558', '483',
                     '56', '603', '127', '133', '98', '1', '652', '144', '698',
                     '474', '82', '510', '216', '211', '531', '357', '162',
                     '161', '697', '50', '157', '302', '694', '606', '221',
                     '432', '116', '334', '692', '480', '527', '274', '333',
                     '33', '245', '404', '174', '129', '178', '11', '182',
                     '134', '137', '462', '205', '663', '467', '511', '32',
                     '513', '529', '664', '530', '319', '273', '693', '197',
                     '69', '60', '708', '170', '602', '582', '701', '185',
                     '499', '276', '629', '478', '59', '192', '654', '709',
                     '482', '414', '518', '617', '230', '470', '699', '589',
                     '238', '502', '430', '180', '70', '23', '700', '525',
                     '153', '85', '40', '12', '286', '179', '479', '610',
                     '707', '484', '686', '604', '93', '9', '198']
    watched_movies_as_numbers = []
    movies_seen_as_numbers = []
    for n in watchedmovies:
        watched_movies_as_numbers.append(int(n))
    for m in movies_seen('10'):
        movies_seen_as_numbers.append(int(m))
    assert movies_seen_as_numbers.sort() == watched_movies_as_numbers.sort()
